<h2>{{ isEdit ? 'Editar cuenta' : 'Nueva cuenta' }}</h2>

<form [formGroup]="f" (ngSubmit)="save()" class="form-grid" novalidate>
  <!-- Número de cuenta -->
  <div class="form-row">
    <label for="number">Número de cuenta</label>
    <input id="number"
           formControlName="number"
           placeholder="Solo dígitos"
           [class.invalid]="fc.number.invalid && (fc.number.touched || submitted)">
    <span class="help" *ngIf="fc.number.errors?.required && (fc.number.touched || submitted)">
      Obligatorio
    </span>
    <span class="help" *ngIf="fc.number.errors?.pattern && (fc.number.touched || submitted)">
      Debe contener solo dígitos (8–20)
    </span>
  </div>

  <!-- Tipo -->
  <div class="form-row">
    <label for="type">Tipo</label>
    <select id="type"
            formControlName="type"
            [class.invalid]="fc.type.invalid && (fc.type.touched || submitted)">
      <option value="Ahorro">Ahorro</option>
      <option value="Corriente">Corriente</option>
    </select>
    <span class="help" *ngIf="fc.type.errors?.required && (fc.type.touched || submitted)">
      Obligatorio
    </span>
  </div>

  <!-- Saldo inicial -->
  <div class="form-row">
    <label for="initialBalance">Saldo inicial</label>
    <input id="initialBalance" type="number"
           formControlName="initialBalance"
           [class.invalid]="fc.initialBalance.invalid && (fc.initialBalance.touched || submitted)">
    <span class="help" *ngIf="fc.initialBalance.errors?.required && (fc.initialBalance.touched || submitted)">
      Obligatorio
    </span>
    <span class="help" *ngIf="fc.initialBalance.errors?.min && (fc.initialBalance.touched || submitted)">
      No puede ser negativo
    </span>
  </div>

  <!-- Cliente -->
  <div class="form-row">
    <label for="clientId">Cliente</label>
    <select id="clientId"
            formControlName="clientId"
            [class.invalid]="fc.clientId.invalid && (fc.clientId.touched || submitted)">
      <option value="" disabled>-- Selecciona cliente --</option>
      <option *ngFor="let c of clientes" [value]="c.id">{{ c.name }}</option>
    </select>
    <span class="help" *ngIf="fc.clientId.errors?.required && (fc.clientId.touched || submitted)">
      Obligatorio
    </span>
  </div>

  <!-- Activo -->
  <div class="form-row">
    <label class="checkbox">
      <input type="checkbox" formControlName="state">
      <span>Activo</span>
    </label>
  </div>

  <!-- Acciones -->
  <div class="form-actions">
    <button class="btn btn-primary" type="submit" [disabled]="f.invalid || saving">
      {{ saving ? 'Guardando...' : 'Guardar' }}
    </button>
    <a class="btn btn-ghost" routerLink="/cuentas">Cancelar</a>
  </div>
</form>